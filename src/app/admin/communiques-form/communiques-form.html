<div class="max-w-2xl mx-auto py-10 px-4 sm:px-6 lg:px-8">
  <div class="bg-white shadow-lg rounded-xl p-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-6">Ajouter un communiqué officiel</h2>

    <div *ngIf="success()" class="mb-6 p-4 bg-green-50 border border-green-200 text-green-800 rounded-lg">
      {{ success() }}
    </div>
    <div *ngIf="error()" class="mb-6 p-4 bg-red-50 border border-red-200 text-red-800 rounded-lg">
      {{ error() }}
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6">

      <!-- Titre -->
      <div>
        <label for="title" class="block text-sm font-medium text-gray-700">Titre *</label>
        <input
          id="title"
          type="text"
          formControlName="title"
          class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm px-4 py-2.5 border"
          [class.border-red-500]="form.get('title')?.touched && form.get('title')?.invalid"
        >
        <p *ngIf="form.get('title')?.touched && form.get('title')?.errors?.['required']" class="mt-1 text-sm text-red-600">
          Le titre est requis
        </p>
        <p *ngIf="form.get('title')?.touched && form.get('title')?.errors?.['minlength']" class="mt-1 text-sm text-red-600">
          Minimum {{ form.get('title')?.errors?.['minlength']?.requiredLength }} caractères
        </p>
      </div>

      <!-- Description -->
      <div>
        <label for="description" class="block text-sm font-medium text-gray-700">Description (optionnel)</label>
        <textarea
          id="description"
          formControlName="description"
          rows="4"
          class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm px-4 py-2.5 border"
        ></textarea>
      </div>

      <!-- Fichier -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Document / Image *</label>
        <div class="mt-1 flex items-center">
          <label class="cursor-pointer bg-gray-100 hover:bg-gray-200 px-5 py-2.5 rounded-lg border border-gray-300 text-gray-700 transition">
            <span>Choisir un fichier</span>
            <input
              id="file"
              type="file"
              class="hidden"
              (change)="onFileChange($event)"
              accept=".pdf,.jpg,.jpeg,.png"
            >
          </label>
          <span class="ml-4 text-sm text-gray-600" *ngIf="selectedFileName()">
            {{ selectedFileName() }}
          </span>
        </div>
        <p *ngIf="form.get('file')?.touched && form.get('file')?.errors?.['required']" class="mt-1 text-sm text-red-600">
          Un fichier est requis
        </p>
      </div>

      <!-- Bouton -->
      <div class="pt-4">
        <button
          type="submit"
          [disabled]="loading() || form.invalid"
          class="w-full bg-green-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-60 disabled:cursor-not-allowed transition"
        >
          {{ loading() ? 'Enregistrement...' : 'Publier le communiqué' }}
        </button>
      </div>
    </form>
  </div>
</div>