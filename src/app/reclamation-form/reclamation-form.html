<div class="font-exo2">
  <h2 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-green-700 text-center mt-6 mb-10">
    RÃ©clamation
  </h2>
  <div class="w-full bg-white lg:py-14 px-4">
    <div class="max-w-7xl mx-auto flex flex-col lg:flex-row gap-12 px-6">
      <!-- COLONNE GAUCHE -->
      <div class="flex-1 max-w-[600px] text-gray-700 leading-relaxed text-lg">
        <p class="max-w-xl">
          Vous avez rencontrÃ© un problÃ¨me avec les services de la
          <span class="font-semibold text-green-700">SEN-CSU&nbsp;?</span>
          DÃ©posez votre rÃ©clamation ici et notre Ã©quipe vous rÃ©pondra rapidement.
        </p>
        <img src="assets/logo.png" alt="Logo SEN-CSU" class="w-80 my-8">
        <div class="w-80 h-[2px] bg-green-700 my-6"></div>
        <h3 class="text-2xl font-semibold text-green-700 mb-4">CoordonnÃ©es de contact</h3>
        <div class="flex items-start gap-3 mb-5">
          <span class="text-green-600 text-2xl">ğŸ“</span>
          <a href="https://www.google.com/maps/place/Agence+de+la+CMU" target="_blank"
             class="text-green-700 hover:underline">
            CitÃ© Keur Gorgui, Lot NÂ°4, Immeuble El Hadji Serigne MÃ©rina SYLLA<br>
            Dakar, SÃ©nÃ©gal
          </a>
        </div>
        <div class="flex items-center gap-3 mb-5">
          <span class="text-green-600 text-2xl">ğŸ“</span>
          <a href="tel:+221338591515" class="text-green-700 hover:underline">
            +221 33 859 15 15
          </a>
        </div>
        <div class="flex items-center gap-3">
          <span class="text-green-600 text-2xl">âœ‰ï¸</span>
          <a href="mailto:contact@agencecmu.sn" class="text-green-700 hover:underline">
            contact@agencecmu.sn
          </a>
        </div>
      </div>

      <!-- FORMULAIRE -->
      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="grid grid-cols-1 sm:grid-cols-2 gap-5 flex-1">
        <input type="text" formControlName="fullname" placeholder="PrÃ©nom et Nom *"
               class="w-full p-4 bg-white border border-gray-200 rounded-md" />
        <div *ngIf="hasError('fullname', 'required')" class="text-red-600 text-sm sm:col-span-2">
          Le nom complet est requis.
        </div>

        <input type="text" formControlName="city" placeholder="Ville *"
               class="w-full p-4 bg-white border border-gray-200 rounded-md" />
        <div *ngIf="hasError('city', 'required')" class="text-red-600 text-sm sm:col-span-2">
          La ville est requise.
        </div>

        <input type="text" formControlName="cardNumber" placeholder="NumÃ©ro de carte dâ€™assurÃ© (facultatif)"
               class="sm:col-span-2 w-full p-4 bg-white border border-gray-200 rounded-md" />

        <input type="tel" formControlName="phone" placeholder="TÃ©lÃ©phone *"
               class="w-full p-4 bg-white border border-gray-200 rounded-md" />
        <div *ngIf="hasError('phone', 'required')" class="text-red-600 text-sm sm:col-span-2">
          Le tÃ©lÃ©phone est obligatoire.
        </div>
        <div *ngIf="hasError('phone', 'invalidPhone')"
             class="text-red-600 text-sm sm:col-span-2">
          NumÃ©ro invalide. Entrez un numÃ©ro valide
          (ex : 761234567, 33 888 88 88, +221771234567, +33123456789).
        </div>

        <input type="email" formControlName="email" placeholder="Email (facultatif)"
               class="w-full p-4 bg-white border border-gray-200 rounded-md" />
        <div *ngIf="hasError('email', 'email')" class="text-red-600 text-sm sm:col-span-2">
          Lâ€™email saisi nâ€™est pas valide.
        </div>

        <select formControlName="subject"
                [ngClass]="{'text-gray-400': !form.get('subject')?.value, 'text-black': form.get('subject')?.value}"
                class="sm:col-span-2 w-full p-4 bg-white border border-gray-200 rounded-md">
          <option value="" disabled selected hidden>Objet de la rÃ©clamation *</option>
          <option>AdhÃ©sion / Carte CSU</option>
          <option>Suivi / Prise en charge</option>
          <option>Autres</option>
        </select>
        <div *ngIf="hasError('subject', 'required')" class="sm:col-span-2 text-red-600 text-sm">
          Lâ€™objet de la rÃ©clamation est requis.
        </div>

        <input *ngIf="form.get('subject')?.value === 'Autres'"
               type="text" formControlName="customSubject"
               placeholder="PrÃ©cisez lâ€™objet *"
               class="sm:col-span-2 w-full p-4 bg-white border border-gray-200 rounded-md" />
        <div *ngIf="form.hasError('customRequired') && form.touched"
             class="sm:col-span-2 text-red-600 text-sm">
          Veuillez prÃ©ciser lâ€™objet quand Â« Autres Â» est choisi.
        </div>

        <textarea formControlName="message" rows="5" placeholder="Le message de votre rÃ©clamation *"
                  class="sm:col-span-2 w-full p-4 bg-white border border-gray-200 rounded-md resize-none"></textarea>
        <div *ngIf="hasError('message', 'required')" class="sm:col-span-2 text-red-600 text-sm">
          Le message est requis.
        </div>

        <!-- HONEYPOT ANTI-SPAM (cachÃ©) -->
        <input type="text" formControlName="_honey" style="display: none;" tabindex="-1" autocomplete="off" />

        <!-- BOUTON -->
        <button type="submit"
                [disabled]="loading"
                class="sm:col-span-2 mt-6 bg-green-700 text-white py-3 px-6 rounded-md font-semibold hover:bg-green-800 transition duration-200 w-full md:w-auto">
          <span *ngIf="!loading">Envoyer â†’</span>
          <span *ngIf="loading">Envoi en cours...</span>
        </button>

        <!-- RÃ‰CAP ERREURS -->
        <div *ngIf="showErrorSummary && form.invalid"
             class="sm:col-span-2 mt-5 p-5 bg-red-50 border border-red-400 rounded-xl">
          <p class="text-red-800 font-semibold mb-3 text-base text-center">
            Veuillez corriger les points suivants avant d'envoyer :
          </p>
          <ul class="list-disc list-inside text-red-700 space-y-2 text-sm">
            <li *ngIf="hasError('fullname', 'required')">â†’ Nom complet manquant</li>
            <li *ngIf="hasError('city', 'required')">â†’ Ville manquante</li>
            <li *ngIf="hasError('phone', 'required')">â†’ TÃ©lÃ©phone manquant</li>
            <li *ngIf="hasError('phone', 'invalidPhone')">â†’ Format tÃ©lÃ©phone incorrect</li>
            <li *ngIf="hasError('subject', 'required')">â†’ Objet non sÃ©lectionnÃ©</li>
            <li *ngIf="form.hasError('customRequired')">â†’ PrÃ©cision obligatoire pour Â« Autres Â»</li>
            <li *ngIf="hasError('message', 'required')">â†’ Message manquant</li>
            <li *ngIf="hasError('email', 'email')">â†’ Email invalide</li>
          </ul>
        </div>

        <!-- MESSAGE OK QUAND TOUT EST CORRIGÃ‰ (avant envoi) -->
        <div *ngIf="showErrorSummary && form.valid"
             class="sm:col-span-2 mt-5 p-5 bg-green-50 border border-green-400 rounded-xl text-center">
          <p class="text-green-800 font-semibold">
            âœ… Parfait ! Tous les champs obligatoires sont correctement remplis.<br>
            Vous pouvez cliquer sur Â« Envoyer Â».
          </p>
        </div>

        <p *ngIf="submitted && !errorMsg"
           class="sm:col-span-2 mt-6 text-green-700 text-center font-medium">
          âœ”ï¸ Votre rÃ©clamation a bien Ã©tÃ© envoyÃ©e ! Nous vous rÃ©pondrons rapidement.
        </p>
        <p *ngIf="errorMsg"
           class="sm:col-span-2 mt-6 text-red-600 text-center font-medium">
          âŒ {{ errorMsg }}
        </p>
      </form>
    </div>
  </div>
</div>